<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using spark functions • flametree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Using spark functions">
<meta property="og:description" content="flametree">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- BEGIN CUSTOM --><!-- adds plausible.io --><script async defer data-domain="flametree.djnavarro.net" src="https://plausible.io/js/plausible.js"></script><!-- END CUSTOM -->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">flametree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../../articles/articles/exploring-styles.html">Exploring styles</a>
    </li>
    <li>
      <a href="../../articles/articles/spark-functions.html">Using spark functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/djnavarro/flametree/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="spark-functions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using spark functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/djnavarro/flametree/blob/master/vignettes/articles/spark-functions.Rmd"><code>vignettes/articles/spark-functions.Rmd</code></a></small>
      <div class="hidden name"><code>spark-functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/djnavarro/flametree">flametree</a></span><span class="op">)</span></code></pre></div>
<p>The growth of the flametree is partially governed by controller functions called “sparks”. A spark function takes four arguments (<code>coord_x</code>, <code>coord_y</code>, <code>id_tree</code>, and <code>id_time</code>) and outputs a numeric value. These functions can be specified manually and used as inputs to <code><a href="../../reference/flametree_grow.html">flametree_grow()</a></code>, or can be generated using one of the built in generator functions. For instance, you can use the <code><a href="../../reference/sparks.html">spark_linear()</a></code> function to create a function that specifies any linear combination of the four inputs:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sparks.html">spark_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; function (coord_x, coord_y, id_tree, id_time) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     (x * coord_x) + (y * coord_y) + (tree * id_tree) + (time * </span>
<span class="co">#&gt;         id_time) + constant</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x7f9500c76638&gt;</span>
<span class="co">#&gt; &lt;environment: 0x7f9500c75bf0&gt;</span></code></pre></div>
<p>We could use this function to control how the colours in the tree change:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/flametree_grow.html">flametree_grow</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="fl">12</span>,
  seg_col <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../../reference/flametree_plot.html">flametree_plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spark-functions_files/figure-html/spark-linear-tree-1-1.png" width="700"></p>
<p>Different parameter settings will produce different linear gradients. For example, we could have the colours change linearly across tree number and time, and have the horizontal spacing of the trees vary linearly with tree number:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/flametree_grow.html">flametree_grow</a></span><span class="op">(</span>
  trees <span class="op">=</span> <span class="fl">5</span>,
  time <span class="op">=</span> <span class="fl">10</span>,
  seg_col <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_linear</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span>, tree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
  shift_x <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_linear</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../../reference/flametree_plot.html">flametree_plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spark-functions_files/figure-html/spark-linear-tree-2-1.png" width="700"></p>
<p>The previous examples all use <code><a href="../../reference/sparks.html">spark_linear()</a></code>, but flametree provides three other spark function generators. The <code><a href="../../reference/sparks.html">spark_nothing()</a></code> generator produces spark function that always returns zero, which is occasionally useful, wheras the <code><a href="../../reference/sparks.html">spark_random()</a></code> function injects uniform random noise. This can be useful with the “native flora” plot style:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/flametree_grow.html">flametree_grow</a></span><span class="op">(</span>
  trees <span class="op">=</span> <span class="fl">10</span>,
  time <span class="op">=</span> <span class="fl">7</span>,
  shift_x <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_random</a></span><span class="op">(</span>multiplier <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  shift_y <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_random</a></span><span class="op">(</span>multiplier <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../../reference/flametree_plot.html">flametree_plot</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"nativeflora"</span><span class="op">)</span></code></pre></div>
<p><img src="spark-functions_files/figure-html/spark-random-1-1.png" width="700"></p>
<p>Defining your own spark function can be fun…</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jittr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">coord_x</span>, <span class="va">coord_y</span>, <span class="va">id_tree</span>, <span class="va">id_time</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">coord_x</span><span class="op">)</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>, max <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="../../reference/flametree_grow.html">flametree_grow</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="fl">12</span>,
  seg_wid <span class="op">=</span> <span class="fu"><a href="../../reference/sparks.html">spark_linear</a></span><span class="op">(</span>constant <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
  shift_x <span class="op">=</span> <span class="va">jittr</span>,
  shift_y <span class="op">=</span> <span class="va">jittr</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../../reference/flametree_plot.html">flametree_plot</a></span><span class="op">(</span>
    palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hotpink4"</span>, <span class="st">"ghostwhite"</span><span class="op">)</span>,
    style <span class="op">=</span> <span class="st">"wisp"</span>
  <span class="op">)</span></code></pre></div>
<p><img src="spark-functions_files/figure-html/custom-spark-1.png" width="700"></p>
<p>…though the results can be peculiar!</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Danielle Navarro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
